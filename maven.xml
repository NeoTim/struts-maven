<?xml version="1.0"?>

<project    default="build-all"
            xmlns:j="jelly:core"
            xmlns:ant="jelly:ant"
            xmlns:maven="jelly:maven">
  
  <!-- this goal should be called from current/build -->
  <goal name="build-all">
  
	<maven:maven
	  descriptor="../mock/project.xml"
	  goals="dist"
	  ignoreFailures="false"
	/>
	
	<maven:maven
	  descriptor="../core/project.xml"
	  goals="dist"
	  ignoreFailures="false"
	/>
	
	<maven:maven
	  descriptor="../taglib/project.xml"
	  goals="dist"
	  ignoreFailures="false"
	/>
	
	<maven:maven
	  descriptor="../tiles/project.xml"
	  goals="dist"
	  ignoreFailures="false"
	/>
	
	<maven:maven
	  descriptor="../apps/project.xml"
	  goals="dist"
	  ignoreFailures="false"
	/>
	
	<maven:maven
	  descriptor="../el/project.xml"
	  goals="dist"
	  ignoreFailures="false"
	/>
	
	<maven:maven
	  descriptor="../bsf/project.xml"
	  goals="dist"
	  ignoreFailures="false"
	/>
	
  </goal>
    
  <goal name="clean-all">
    <maven:reactor  
              basedir="./"
             includes="../*/project.xml"
             excludes="build/project.xml"
                goals="clean"
               banner="Cleaning Struts distribution"
       ignoreFailures="false"/>
  </goal>

  <postGoal name="dist">
	<attainGoal name="jar:install"/>
  </postGoal>

  <postGoal name="dist:prepare-bin-filesystem">
    <!-- Copy Instructions and Readmes -->
    <ant:copy todir="${maven.dist.bin.assembly.dir}">
      <ant:fileset dir="build/">
        <ant:include name="README*"/>
        <ant:include name="LICENSE*"/>
        <ant:include name="STATUS*"/>
        <ant:include name="INSTALL*"/>
      </ant:fileset>
    </ant:copy>
  </postGoal>

  <postGoal name="dist:prepare-src-filesystem">
    <!-- Copy Instructions and Readmes -->
    <ant:copy todir="${maven.dist.src.assembly.dir}">
      <ant:fileset dir="build">
        <ant:include name="README*"/>
        <ant:include name="LICENSE*"/>
        <ant:include name="STATUS*"/>
        <ant:include name="INSTALL*"/>
      </ant:fileset>
    </ant:copy>
  </postGoal>

</project>